@page "/twitterreport"
@*@attribute [Authorize(Roles = "Admin")]*@
@using System.Text.Json
@using System.Text.Json.Serialization
@using System.Net.Http.Headers
@using promoit_frontend_cs.Services;
@inject HttpClient Http
@using Newtonsoft.Json;
@inject SocialActivistService socialActivistService


<h3>Twitter report</h3>

@if (twitterReports.Count() > 0)
{
    <table class="table table-hover table-striped">
        <thead class="table-dark">
            <tr>
                <th>Campaign</th>
                <th>Tweets</th>
                <th>Retweets</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var twitterReport in twitterReports)
            {
                <tr>
                    <td>@twitterReport.campaign</td>
                    <td>@twitterReport.tweets</td>
                    <td>@twitterReport.retweets</td>
                </tr>
            }
        </tbody>
    </table>
}
else
{
    <h4>Loading data</h4>
}

@functions {

    private IEnumerable<TwitterReportType> twitterReports = Array.Empty<TwitterReportType>();

    protected override async Task OnInitializedAsync()
    {
        twitterReports = await socialActivistService.GetTwitterReport();
    }
}
